
@model WebApplication3.Views.CustomerCalls.AddCall

<style>
    .back-button {

    }

    .flex-items {

        display: flex;
        gap: 20px;
    }
</style>

@{
    var customerId = ViewBag.CustomerId; 

}

<header>
    <!-- Your header code remains unchanged -->
</header>

<h2>Call Form</h2>
<a href="/CustomerCalls">Back to Calls</a>
<form id="callForm">
    <div>
        <label for="customerId">Customer ID:</label>
        <input  id="customerId" name="CustomerId" value="@customerId">
        <small>You didn't specify how you want the relationship between a call and a customer to be defined in order to create a new call (e.g., unique name).</small>
    </div>

    <div>
        <label for="dateOfCall">Date of Call:</label>
        <input type="date" id="dateOfCall" name="DateOfCall">
    </div>

    <div>
        <label for="timeOfCall">Time of Call:</label>
        <input type="time" id="timeOfCall" name="TimeOfCall">
    </div>

    <div>
        <label for="subject">Subject:</label>
        <input type="text" id="subject" name="Subject">
    </div>

    <div>
        <label for="description">Description:</label>
        <input type="text" id="description" name="Description">
    </div>

    <div class="flex-items" id="flex-items">
        <button type="button" id="submitBtn">Submit</button>
    </div>
</form>

@section scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('submitBtn').addEventListener('click', function () {

                let formData = new FormData(document.getElementById('callForm'));
                let myForm = $('#callForm');
                fetch('/add-save-call', {
                    method: 'POST',
                    body: myForm.serialize(),
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                })
                .then(res => {
                    document.getElementById('callForm').reset();
                    // Redirect to the appropriate page or perform any other action
                    // Example: window.location.href = '/calls';
                })
                .catch(error => {
                    console.error(error);
                });
            });
        });
    </script>
}
